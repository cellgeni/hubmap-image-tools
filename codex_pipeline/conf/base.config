
singularity {

    enabled = true
    autoMounts = true
    runOptions = '--nv -B /hive/users/keays/cytokit -B /hive/users/keays/cytokit/lab/data:/lab/data -B $HUBMAP_LZ'
    cacheDir = '/hive/users/keays/singularity'
    envWhitelist = 'CYTOKIT_ENV, HUBMAP_IMAGE_TOOLS, HUBMAP_LZ'
}

process {

    maxRetries = 2
    maxErrors = '-1'
    errorStrategy = 'terminate'


    // Process-specific parameters

    withName: 'setup_data_directory' {

        // Python3 on the HIVE cluster is 3.7.4
        container = "quay.io/mkeays/hubmap-image-tools"

    }

    withName: 'create_yaml_config' {

        // Python3 on the HIVE cluster is 3.7.4
        container = "quay.io/mkeays/hubmap-image-tools"

    }

    withName: 'run_cytokit_processor' {

        container = "eczech/cytokit:latest"
    }
}
